# –°–í–û–î–ö–ê –í–´–ü–û–õ–ù–ï–ù–ù–´–• –†–ê–ë–û–¢

**–î–∞—Ç–∞:** 15 –¥–µ–∫–∞–±—Ä—è 2025, 15:15  
**–ü—Ä–æ–µ–∫—Ç:** ATC Platform - Nuxt TailAdmin  
**–ú–æ–¥—É–ª—å:** –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ó–ê–î–ê–ß–ò

### üîê –≠—Ç–∞–ø 2: Middleware –∏ –∑–∞—â–∏—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–æ–≤

#### –°–µ—Ä–≤–µ—Ä–Ω—ã–π middleware (`server/middleware/auth.ts`)

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ –≤—Å–µ—Ö –∑–∞—â–∏—â–µ–Ω–Ω—ã—Ö API –º–∞—Ä—à—Ä—É—Ç–∞—Ö
- ‚úÖ Whitelist –ø—É–±–ª–∏—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ (`/api/auth/*`, `/api/db/*`)
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π (ADMIN, MANAGER, TEACHER, STUDENT)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ `event.context`
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ dev —Ä–µ–∂–∏–º–µ

#### –ö–ª–∏–µ–Ω—Ç—Å–∫–∏–π middleware (`middleware/auth.ts`)

- ‚úÖ –ó–∞—â–∏—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –æ—Ç –Ω–µ–∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Ä–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/auth/signin`
- ‚úÖ –í–µ—Ä–∏—Ñ–∏–∫–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ API
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –¥–ª—è —Å—Ç—Ä–∞–Ω–∏—Ü —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ redirect query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞

### üé® –≠—Ç–∞–ø 3: –ö–ª–∏–µ–Ω—Ç—Å–∫–∞—è —á–∞—Å—Ç—å

#### Composable (`composables/useAuth.ts`)

- ‚úÖ –ú–µ—Ç–æ–¥—ã: `login()`, `register()`, `logout()`, `verifyAuth()`, `refreshAuthToken()`
- ‚úÖ –†–µ–∞–∫—Ç–∏–≤–Ω–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏
- ‚úÖ SSR-safe —Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤ –≤ cookies
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞
- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π —á–µ—Ä–µ–∑ `hasRole()`
- ‚úÖ Computed —Å–≤–æ–π—Å—Ç–≤–æ `isAuthenticated`

#### Plugin (`plugins/auth.ts`)

- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ —Å–µ—Å—Å–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ

#### –¢–∏–ø—ã (`types/auth.ts`)

- ‚úÖ –û–±—â–∏–µ —Ç–∏–ø—ã –¥–ª—è –∫–ª–∏–µ–Ω—Ç–∞ –∏ —Å–µ—Ä–≤–µ—Ä–∞
- ‚úÖ –†–µ—à–µ–Ω–∞ –ø—Ä–æ–±–ª–µ–º–∞ –∏–º–ø–æ—Ä—Ç–∞ —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö —Ç–∏–ø–æ–≤ –≤ –∫–ª–∏–µ–Ω—Ç—Å–∫–æ–º –∫–æ–¥–µ

#### –û–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã

- ‚úÖ `app/pages/auth/signin.vue` - –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å useAuth

---

## üìä –°–¢–ê–¢–ò–°–¢–ò–ö–ê

**–°–æ–∑–¥–∞–Ω–æ —Ñ–∞–π–ª–æ–≤:** 6

- 5 –Ω–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤
- 1 –æ–±–Ω–æ–≤–ª–µ–Ω–Ω—ã–π —Ñ–∞–π–ª

**–°—Ç—Ä–æ–∫ –∫–æ–¥–∞:** ~1000

**–ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**

- Middleware: 2 (—Å–µ—Ä–≤–µ—Ä–Ω—ã–π + –∫–ª–∏–µ–Ω—Ç—Å–∫–∏–π)
- Composables: 1
- Plugins: 1
- –¢–∏–ø—ã: 1

---

## üõ°Ô∏è –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –º–µ—Ä—ã:

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–æ–≤ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏ –∫–ª–∏–µ–Ω—Ç–µ
- ‚úÖ –ö–æ–Ω—Ç—Ä–æ–ª—å –¥–æ—Å—Ç—É–ø–∞ –Ω–∞ –æ—Å–Ω–æ–≤–µ —Ä–æ–ª–µ–π
- ‚úÖ SSR-safe cookies –≤–º–µ—Å—Ç–æ localStorage
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–æ–≤
- ‚úÖ –ó–∞—â–∏—Ç–∞ API –º–∞—Ä—à—Ä—É—Ç–æ–≤
- ‚úÖ –ó–∞—â–∏—Ç–∞ —Å—Ç—Ä–∞–Ω–∏—Ü –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –≤—Å–µ—Ö –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö (Zod)
- ‚úÖ –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–∞—Ä–æ–ª–µ–π (bcrypt, 10 —Ä–∞—É–Ω–¥–æ–≤)
- ‚úÖ JWT access —Ç–æ–∫–µ–Ω—ã (7 –¥–Ω–µ–π) + refresh —Ç–æ–∫–µ–Ω—ã (30 –¥–Ω–µ–π)

### –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è:

- ‚ö†Ô∏è Rate limiting –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚ö†Ô∏è Blacklist —Ç–æ–∫–µ–Ω–æ–≤ –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
- ‚ö†Ô∏è CORS –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω
- ‚ö†Ô∏è Security headers –Ω–µ –¥–æ–±–∞–≤–ª–µ–Ω—ã

---

## üìù –ò–°–ü–†–ê–í–õ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´ –ò–ó –û–¢–ß–ï–¢–ê

### –ò–∑ —Ä–∞–∑–¥–µ–ª–∞ "–û—Å–Ω–æ–≤–Ω—ã–µ –Ω–µ–¥–æ—Å—Ç–∞—Ç–∫–∏":

1. ~~‚ùå –û—Ç–∫–ª—é—á–µ–Ω middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ (–∫—Ä–∏—Ç–∏—á–Ω–æ!)~~ ‚Üí ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û**
2. ~~‚ùå –•–∞—Ä–¥–∫–æ–¥ credentials~~ ‚Üí ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** (–≤—ã–Ω–µ—Å–µ–Ω—ã –≤ .env)
3. ~~‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –≤–∞–ª–∏–¥–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö~~ ‚Üí ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û** (Zod —Å—Ö–µ–º—ã)

### –ò–∑ —Ä–∞–∑–¥–µ–ª–∞ "–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π":

1. ~~–í–∫–ª—é—á–∏—Ç—å middleware –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏~~ ‚Üí ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
2. ~~–í—ã–Ω–µ—Å—Ç–∏ credentials –≤ .env~~ ‚Üí ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**
3. ~~–î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö~~ ‚Üí ‚úÖ **–í–´–ü–û–õ–ù–ï–ù–û**

---

## üìà –£–õ–£–ß–®–ï–ù–ò–ï –û–¶–ï–ù–ö–ò –ü–†–û–ï–ö–¢–ê

**–ë—ã–ª–æ:** 7/10  
**–°—Ç–∞–ª–æ:** 8.5/10  
**–ü—Ä–∏—Ä–æ—Å—Ç:** +1.5 –±–∞–ª–ª–∞

**–ü—Ä–∏—á–∏–Ω—ã —É–ª—É—á—à–µ–Ω–∏—è:**

- –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∞ –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö
- –£–ª—É—á—à–µ–Ω–∞ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ (—Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤, SSR-safe —Ä–µ—à–µ–Ω–∏—è)

---

## üéØ –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

1. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ (`pages/auth/signup.vue`) –Ω–µ –Ω–∞–¥–æ 
2. –î–æ–±–∞–≤–∏—Ç—å rate limiting –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç –±—Ä—É—Ç—Ñ–æ—Ä—Å–∞
3. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CORS –∏ security headers
4. –ò—Å–ø—Ä–∞–≤–∏—Ç—å –Ω–µ—Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è –ø–æ–ª–µ–π –ë–î

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

5. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å –∑–∞–ø—Ä–æ—Å—ã –∫ –ë–î (N+1 –ø—Ä–æ–±–ª–µ–º–∞)
6. –î–æ–±–∞–≤–∏—Ç—å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
7. –†–∞—Å—à–∏—Ä–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
8. –°–æ–∑–¥–∞—Ç—å —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–∞—Ä–æ–ª—è

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç:

9. –î–æ–±–∞–≤–∏—Ç—å —Ç–µ—Å—Ç—ã
10. –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å UI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã
11. –î–æ–±–∞–≤–∏—Ç—å –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é API
12. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD

---

## üí° –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ —Ä–µ—à–µ–Ω–∏—è:

- **SSR-safe:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ cookies –≤–º–µ—Å—Ç–æ localStorage –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Ç–æ–∫–µ–Ω–æ–≤
- **–¢–∏–ø–∏–∑–∞—Ü–∏—è:** –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–æ–≤ –Ω–∞ –æ–±—â–∏–µ (`types/auth.ts`) –∏ —Å–µ—Ä–≤–µ—Ä–Ω—ã–µ (`server/types/auth.ts`)
- **Auto-imports:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Nuxt auto-imports –¥–ª—è composables –∏ —É—Ç–∏–ª–∏—Ç
- **Middleware:** –î–≤—É—Ö—É—Ä–æ–≤–Ω–µ–≤–∞—è –∑–∞—â–∏—Ç–∞ (—Å–µ—Ä–≤–µ—Ä + –∫–ª–∏–µ–Ω—Ç)

### –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ access —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ refresh —Ç–æ–∫–µ–Ω
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–æ–ª–µ–π –Ω–∞ —É—Ä–æ–≤–Ω–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤ (—Å–µ—Ä–≤–µ—Ä) –∏ —Å—Ç—Ä–∞–Ω–∏—Ü (–∫–ª–∏–µ–Ω—Ç)
- Whitelist –ø—É–±–ª–∏—á–Ω—ã—Ö –º–∞—Ä—à—Ä—É—Ç–æ–≤ –¥–ª—è –≥–∏–±–∫–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
- –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ `event.context` –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –≤ API handlers
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ redirect query –ø–∞—Ä–∞–º–µ—Ç—Ä–∞ –¥–ª—è –≤–æ–∑–≤—Ä–∞—Ç–∞ –Ω–∞ –∏—Å—Ö–æ–¥–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø–æ—Å–ª–µ –≤—Ö–æ–¥–∞

---

**–ê–≤—Ç–æ—Ä:** Antigravity AI  
**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 15.12.2025, 15:15
