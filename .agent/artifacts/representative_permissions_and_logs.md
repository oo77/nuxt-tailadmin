# –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ –∏ –∂—É—Ä–Ω–∞–ª –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π

## –î–∞—Ç–∞: 2025-12-29

## –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–π –∏ –∂—É—Ä–Ω–∞–ª –∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram-–±–æ—Ç—É.

---

## 1. UI —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç: `RepresentativeDetailModal.vue`

#### –î–æ–±–∞–≤–ª–µ–Ω–Ω–∞—è —Å–µ–∫—Ü–∏—è "–†–∞–∑—Ä–µ—à–µ–Ω–∏—è Telegram-–±–æ—Ç–∞":

**–ß–µ–∫–±–æ–∫—Å—ã –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏:**

- ‚úÖ **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–ø–∏—Å–∫–∞ —Å–ª—É—à–∞—Ç–µ–ª–µ–π** (`can_view_students`)

  - –ö–æ–º–∞–Ω–¥–∞: `/students`
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–ª—É—à–∞—Ç–µ–ª–µ–π –æ—Ä–≥–∞–Ω–∏–∑–∞—Ü–∏–∏

- ‚úÖ **–ü—Ä–æ—Å–º–æ—Ç—Ä —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è** (`can_view_schedule`)

  - –ö–æ–º–∞–Ω–¥–∞: `/schedule`
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ –∑–∞–Ω—è—Ç–∏–π –Ω–∞ –Ω–µ–¥–µ–ª—é

- ‚úÖ **–ü—Ä–æ—Å–º–æ—Ç—Ä —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤** (`can_view_certificates`)

  - –ö–æ–º–∞–Ω–¥–∞: `/certificates`
  - –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å–ø–∏—Å–æ–∫ –≤—ã–¥–∞–Ω–Ω—ã—Ö —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤

- ‚úÖ **–ó–∞–ø—Ä–æ—Å —Ñ–∞–π–ª–æ–≤ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤** (`can_request_certificates`)
  - –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Å–∫–∞—á–∏–≤–∞—Ç—å PDF —Ñ–∞–π–ª—ã —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤
  - –ó–∞–≤–∏—Å–∏—Ç –æ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è `can_view_certificates`

#### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:

- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Ç–µ–∫—É—â–∏—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- –†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π —Å –ø–æ–º–æ—â—å—é —á–µ–∫–±–æ–∫—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ `can_request_certificates` –ø—Ä–∏ –æ—Ç–∫–ª—é—á–µ–Ω–∏–∏ `can_view_certificates`
- –ö–Ω–æ–ø–∫–∞ "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å" –ø–æ—è–≤–ª—è–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- –ò–Ω–¥–∏–∫–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–± —É—Å–ø–µ—Ö–µ/–æ—à–∏–±–∫–µ

---

## 2. API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏

### Endpoint: `PATCH /api/representatives/[id]`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö —Å –ø–æ–º–æ—â—å—é Zod
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

**–ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞:**

```json
{
  "permissions": {
    "can_view_students": true,
    "can_view_schedule": true,
    "can_view_certificates": true,
    "can_request_certificates": false
  }
}
```

**–û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:**

- `updateRepresentative` —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ `permissions` –∏ `canReceiveNotifications`
- JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ –∏–∑–º–µ–Ω—ë–Ω–Ω—ã—Ö –ø–æ–ª–µ–π

---

## 3. –ñ—É—Ä–Ω–∞–ª –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ Telegram-–±–æ—Ç—É

### –ú–∏–≥—Ä–∞—Ü–∏—è: `20251229_024_telegram_bot_requests`

#### –¢–∞–±–ª–∏—Ü–∞ `telegram_bot_requests`:

**–ü–æ–ª—è:**

- `id` - UUID –∑–∞–ø—Ä–æ—Å–∞
- `representative_id` - ID –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è
- `chat_id` - Telegram Chat ID
- `command` - –ö–æ–º–∞–Ω–¥–∞ –∏–ª–∏ –¥–µ–π—Å—Ç–≤–∏–µ (–Ω–∞–ø—Ä–∏–º–µ—Ä, `/students`)
- `request_type` - –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞:
  - `command` - –∫–æ–º–∞–Ω–¥–∞
  - `callback` - callback –æ—Ç inline –∫–Ω–æ–ø–∫–∏
  - `message` - —Ç–µ–∫—Å—Ç–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
- `request_data` - JSON —Å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏
- `status` - –°—Ç–∞—Ç—É—Å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:
  - `success` - —É—Å–ø–µ—à–Ω–æ
  - `error` - –æ—à–∏–±–∫–∞
  - `denied` - –æ—Ç–∫–∞–∑–∞–Ω–æ (–Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è)
- `error_message` - –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
- `response_time_ms` - –í—Ä–µ–º—è –æ—Ç–≤–µ—Ç–∞ –≤ –º–∏–ª–ª–∏—Å–µ–∫—É–Ω–¥–∞—Ö
- `created_at` - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è –∑–∞–ø—Ä–æ—Å–∞

**–ò–Ω–¥–µ–∫—Å—ã:**

- –ü–æ `representative_id`
- –ü–æ `chat_id`
- –ü–æ `command`
- –ü–æ `request_type`
- –ü–æ `status`
- –ü–æ `created_at`
- –°–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å `(representative_id, created_at DESC)`

---

## 4. –£—Ç–∏–ª–∏—Ç–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è: `botLogger.ts`

### –§—É–Ω–∫—Ü–∏–∏:

#### `logBotRequest(params)`

–õ–æ–≥–∏—Ä—É–µ—Ç –∑–∞–ø—Ä–æ—Å –∫ –±–æ—Ç—É.

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**

```typescript
{
  representativeId: string;
  chatId: string | number;
  command: string;
  requestType?: 'command' | 'callback' | 'message';
  requestData?: Record<string, any>;
  status?: 'success' | 'error' | 'denied';
  errorMessage?: string;
  responseTimeMs?: number;
}
```

#### `getBotRequestHistory(representativeId, limit, offset)`

–ü–æ–ª—É—á–∞–µ—Ç –∏—Å—Ç–æ—Ä–∏—é –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**

```typescript
{
  id: string;
  representativeId: string;
  chatId: number;
  command: string;
  requestType: string;
  requestData: any;
  status: string;
  errorMessage: string | null;
  responseTimeMs: number | null;
  createdAt: Date;
}
[];
```

#### `getBotRequestStats(representativeId)`

–ü–æ–ª—É—á–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –∑–∞–ø—Ä–æ—Å–æ–≤.

**–í–æ–∑–≤—Ä–∞—â–∞–µ—Ç:**

```typescript
{
  total: number;
  success: number;
  error: number;
  denied: number;
  lastRequest: Date | null;
}
```

#### `cleanupOldBotRequests(daysToKeep)`

–û—á–∏—â–∞–µ—Ç —Å—Ç–∞—Ä—ã–µ –ª–æ–≥–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π).

---

## 5. API –¥–ª—è –∂—É—Ä–Ω–∞–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

### Endpoint: `GET /api/representatives/[id]/requests`

**Query –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**

- `limit` - –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 50)
- `offset` - –°–º–µ—â–µ–Ω–∏–µ –¥–ª—è –ø–∞–≥–∏–Ω–∞—Ü–∏–∏ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 0)

**–û—Ç–≤–µ—Ç:**

```json
{
  "success": true,
  "data": {
    "history": [...],
    "stats": {
      "total": 150,
      "success": 145,
      "error": 3,
      "denied": 2,
      "lastRequest": "2025-12-29T06:45:00.000Z"
    },
    "pagination": {
      "limit": 50,
      "offset": 0,
      "total": 150
    }
  }
}
```

---

## 6. UI –∂—É—Ä–Ω–∞–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç: `RepresentativeDetailModal.vue`

#### –°–µ–∫—Ü–∏—è "–ñ—É—Ä–Ω–∞–ª –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–æ—Ç—É":

**–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è –æ–¥–æ–±—Ä–µ–Ω–Ω—ã—Ö –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π.**

**–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ (–≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω–∞):**

- –í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤
- –£—Å–ø–µ—à–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –û—à–∏–±–æ–∫
- –û—Ç–∫–∞–∑–∞–Ω–æ (–Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è)

**–ò—Å—Ç–æ—Ä–∏—è –∑–∞–ø—Ä–æ—Å–æ–≤ (–ø–æ –∫–Ω–æ–ø–∫–µ "–ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é"):**

- –ü–æ—Å–ª–µ–¥–Ω–∏–µ 10 –∑–∞–ø—Ä–æ—Å–æ–≤
- –î–ª—è –∫–∞–∂–¥–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞:
  - –ö–æ–º–∞–Ω–¥–∞
  - –¢–∏–ø –∑–∞–ø—Ä–æ—Å–∞ (command/callback/message)
  - –°—Ç–∞—Ç—É—Å (–∏–Ω–¥–∏–∫–∞—Ç–æ—Ä —Ü–≤–µ—Ç–æ–º)
  - –î–∞—Ç–∞ –∏ –≤—Ä–µ–º—è
  - –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è
  - –°–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ (–µ—Å–ª–∏ –µ—Å—Ç—å)

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª:**

- –ö–Ω–æ–ø–∫–∞ "–ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é" / "–°–∫—Ä—ã—Ç—å –∏—Å—Ç–æ—Ä–∏—é"
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏
- –ü—Ä–æ–∫—Ä—É—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ (max-height: 384px)
- –¶–≤–µ—Ç–æ–≤–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è —Å—Ç–∞—Ç—É—Å–∞:
  - üü¢ –ó–µ–ª—ë–Ω—ã–π - success
  - üî¥ –ö—Ä–∞—Å–Ω—ã–π - error
  - üü° –ñ—ë–ª—Ç—ã–π - denied

---

## 7. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ Telegram-–±–æ—Ç–µ

### –û–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:

#### `/students`

–õ–æ–≥–∏—Ä—É–µ—Ç:

- ‚úÖ –£—Å–ø–µ—à–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ (—Å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ–º —Å–ª—É—à–∞—Ç–µ–ª–µ–π)
- ‚ùå –û—Ç–∫–∞–∑ (–Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è)
- ‚ö†Ô∏è –û—à–∏–±–∫—É –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞ —É—Å–ø–µ—Ö–∞:**

```typescript
{
  command: '/students',
  status: 'success',
  requestData: { studentsCount: 25 },
  responseTimeMs: 150
}
```

**–ü—Ä–∏–º–µ—Ä –ª–æ–≥–∞ –æ—Ç–∫–∞–∑–∞:**

```typescript
{
  command: '/students',
  status: 'denied',
  errorMessage: '–ù–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è can_view_students',
  responseTimeMs: 50
}
```

### –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è:

- `/schedule`
- `/certificates`
- Callback –∑–∞–ø—Ä–æ—Å—ã (–æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç–æ–≤)

---

## 8. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞:

1. **–û—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è**

   - –ü–µ—Ä–µ–π—Ç–∏ –≤ "–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏" ‚Üí "–ü—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–∏"
   - –ö–ª–∏–∫–Ω—É—Ç—å –Ω–∞ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è

2. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è**

   - –û—Ç–º–µ—Ç–∏—Ç—å/—Å–Ω—è—Ç—å —á–µ–∫–±–æ–∫—Å—ã –Ω—É–∂–Ω—ã—Ö —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
   - –ù–∞–∂–∞—Ç—å "–°–æ—Ö—Ä–∞–Ω–∏—Ç—å"

3. **–ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –∂—É—Ä–Ω–∞–ª**
   - –ù–∞–∂–∞—Ç—å "–ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é" –≤ —Å–µ–∫—Ü–∏–∏ "–ñ—É—Ä–Ω–∞–ª –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –±–æ—Ç—É"
   - –ü—Ä–æ—Å–º–æ—Ç—Ä–µ—Ç—å –ø–æ—Å–ª–µ–¥–Ω–∏–µ –∑–∞–ø—Ä–æ—Å—ã –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É

### –î–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è:

–ü–æ—Å–ª–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:

- –ö–æ–º–∞–Ω–¥—ã, –Ω–∞ –∫–æ—Ç–æ—Ä—ã–µ –Ω–µ—Ç —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è, –≤–µ—Ä–Ω—É—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç–∫–∞–∑–µ
- –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–æ–º–∞–Ω–¥ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

---

## 9. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ü—Ä–æ–≤–µ—Ä–∫–∏:

1. –°—Ç–∞—Ç—É—Å –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è (`approved`)
2. –ù–∞–ª–∏—á–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –ø–æ–ø—ã—Ç–æ–∫ –¥–æ—Å—Ç—É–ø–∞ (–≤–∫–ª—é—á–∞—è –æ—Ç–∫–∞–∑—ã)

### –ê—É–¥–∏—Ç:

- –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `activity_logs`
- –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∫ –±–æ—Ç—É –ª–æ–≥–∏—Ä—É—é—Ç—Å—è –≤ `telegram_bot_requests`
- –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å –æ—Ç—Å–ª–µ–¥–∏—Ç—å:
  - –ö—Ç–æ –∏ –∫–æ–≥–¥–∞ –∏–∑–º–µ–Ω–∏–ª —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
  - –ö–∞–∫–∏–µ –∫–æ–º–∞–Ω–¥—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–ª –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—å
  - –ë—ã–ª–∏ –ª–∏ –ø–æ–ø—ã—Ç–∫–∏ –Ω–µ—Å–∞–Ω–∫—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞

---

## 10. –û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ

### –û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –ª–æ–≥–æ–≤:

–†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –æ—á–∏—Å—Ç–∫—É:

```typescript
import { cleanupOldBotRequests } from "./utils/botLogger";

// –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–≥–∏ —Å—Ç–∞—Ä—à–µ 90 –¥–Ω–µ–π
const deleted = await cleanupOldBotRequests(90);
console.log(`–£–¥–∞–ª–µ–Ω–æ ${deleted} —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π`);
```

–ú–æ–∂–Ω–æ –Ω–∞—Å—Ç—Ä–æ–∏—Ç—å cron job –∏–ª–∏ scheduled task.

---

## 11. –ú–∏–≥—Ä–∞—Ü–∏–∏

### –ü—Ä–∏–º–µ–Ω—ë–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏:

1. `20251229_023_certificate_validity_and_permissions` - –†–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π
2. `20251229_024_telegram_bot_requests` - –ñ—É—Ä–Ω–∞–ª –∑–∞–ø—Ä–æ—Å–æ–≤

### –ö–æ–º–∞–Ω–¥—ã:

```bash
# –ü—Ä–∏–º–µ–Ω–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏
npm run db:migrate

# –û—Ç–∫–∞—Ç–∏—Ç—å –ø–æ—Å–ª–µ–¥–Ω—é—é –º–∏–≥—Ä–∞—Ü–∏—é
npm run db:rollback

# –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å—Ç–∞—Ç—É—Å
npm run db:status
```

---

## 12. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –°—Ü–µ–Ω–∞—Ä–∏–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è:

1. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏:**

   - –û—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è
   - –ò–∑–º–µ–Ω–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è
   - –°–æ—Ö—Ä–∞–Ω–∏—Ç—å
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –∏–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–∏–ª–∏—Å—å

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π –≤ –±–æ—Ç–µ:**

   - –û—Ç–∫–ª—é—á–∏—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–µ `can_view_students`
   - –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –∫–æ–º–∞–Ω–¥—É `/students` –≤ –±–æ—Ç–µ
   - –î–æ–ª–∂–Ω–æ –ø—Ä–∏–π—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—Ç–∫–∞–∑–µ

3. **–ñ—É—Ä–Ω–∞–ª –∑–∞–ø—Ä–æ—Å–æ–≤:**

   - –í—ã–ø–æ–ª–Ω–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∫–æ–º–∞–Ω–¥ –≤ –±–æ—Ç–µ
   - –û—Ç–∫—Ä—ã—Ç—å –¥–µ—Ç–∞–ª–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—è
   - –ù–∞–∂–∞—Ç—å "–ü–æ–∫–∞–∑–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é"
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –∑–∞–ø—Ä–æ—Å—ã –∑–∞–ª–æ–≥–∏—Ä–æ–≤–∞–Ω—ã

4. **–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π:**
   - –û—Ç–∫–ª—é—á–∏—Ç—å `can_view_certificates`
   - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ `can_request_certificates` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–∫–ª—é—á–∏–ª—Å—è
   - –ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å –≤–∫–ª—é—á–∏—Ç—å `can_request_certificates` –±–µ–∑ `can_view_certificates`
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ

---

## –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è–º–∏ –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª–µ–π —Å:

- ‚úÖ –£–¥–æ–±–Ω—ã–º UI –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏–π
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–º –∂—É—Ä–Ω–∞–ª–æ–º –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–æ–π –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –±–æ—Ç–∞
- ‚úÖ –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é –Ω–∞ –≤—Å–µ—Ö —É—Ä–æ–≤–Ω—è—Ö
- ‚úÖ –ê—É–¥–∏—Ç–æ–º –≤—Å–µ—Ö –¥–µ–π—Å—Ç–≤–∏–π

–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Ç–µ–ø–µ—Ä—å –∏–º–µ–µ—Ç –ø–æ–ª–Ω—ã–π –∫–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ —Ç–µ–º, –∫–∞–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞ –¥–æ—Å—Ç—É–ø–Ω—ã –∫–∞–∂–¥–æ–º—É –ø—Ä–µ–¥—Å—Ç–∞–≤–∏—Ç–µ–ª—é, –∏ –º–æ–∂–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –∏—Ö –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å.
